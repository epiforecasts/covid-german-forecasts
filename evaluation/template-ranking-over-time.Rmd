
    
    
```{r ranking-time, results = 'asis', fig.width=10, fig.height=9}
scores <- scoringutils::eval_forecasts(data,
                                         summarise_by = c("model", 
                                                          "location_name", 
                                                          "target_type",
                                                          "forecast_date"), 
                                       compute_relative_skill = FALSE)

ranked_scores <- scores %>%
    dplyr::mutate(forecast_date = as.Date(forecast_date)) %>%
    dplyr::group_by(forecast_date, location_name, target_type) %>%
    dplyr::mutate(rank = rank(interval_score, ties.method = "average",
                              na.last = NA)) %>%
    dplyr::ungroup()


plot <- score_heatmap(ranked_scores, metric = "rank", 
                      x = "forecast_date",
                      facet_wrap_or_grid = "grid",
                      facet_formula = location_name ~ target_type) + 
  ggplot2::theme(legend.position = "bottom")

print(plot)

```